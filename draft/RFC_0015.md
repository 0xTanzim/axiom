# RFC-0015: Module Architecture

**Status:** Accepted
**Priority:** P0 (DX-Critical)
**Created:** 2026-01-18
**Updated:** 2026-01-18
**Author:** Axiom Team

---

## 1. Problem Statement

Users should NOT need to know internal module structure.

**Bad DX:**
```xml
<dependency>axiom-core</dependency>
<dependency>axiom-config</dependency>
<dependency>axiom-di</dependency>
<dependency>axiom-server</dependency>
<dependency>axiom-validation</dependency>
<dependency>axiom-persistence</dependency>
```

**Good DX:**
```xml
<dependency>
    <groupId>io.axiom</groupId>
    <artifactId>axiom</artifactId>
    <version>0.1.0</version>
</dependency>
```

---

## 2. Decision: Minimal Module Architecture

### Foundation Modules (4 Total)

| Module | Purpose | External Dependencies |
|--------|---------|----------------------|
| `axiom-core` | Everything: routing, config, DI, validation, server | SmallRye Config, Dagger 2, Hibernate Validator |
| `axiom-persistence` | Database access, transactions | HikariCP |
| `axiom-persistence-processor` | Compile-time @Transactional processor | None |
| `axiom` (framework) | **THE ONLY DEPENDENCY USERS NEED** | Bundles core + persistence |

### Why axiom-persistence-processor is separate

**Technical requirement.** Java annotation processors MUST be in separate JAR files from the classes they generate code for. This is a Maven/Gradle compilation order constraint.

---

## 3. User Experience

```xml
<!-- This is ALL users need -->
<dependency>
    <groupId>io.axiom</groupId>
    <artifactId>axiom</artifactId>
    <version>0.1.0</version>
</dependency>
```

Then just code:

```java
import io.axiom.Axiom;

public class App {
    public static void main(String[] args) {
        Axiom.create()
            .get("/", ctx -> ctx.text("Hello!"))
            .start();
    }
}
```

---

## 4. axiom-core Contains

| Package | Purpose |
|---------|---------|
| `io.axiom.core.*` | Routing, context, handlers, middleware, lifecycle |
| `io.axiom.config` | Configuration (SmallRye Config) |
| `io.axiom.di` | DI annotations (@Service, @Repository) for Dagger 2 |
| `io.axiom.validation` | Validation (Hibernate Validator) |
| `io.axiom.server` | JDK HTTP Server implementation |

---

## 5. Final Structure

```
axiom/                              ← Root
├── axiom-core/                     ← Everything merged here
│   └── io/axiom/
│       ├── core/                   ← Routing, context, handlers
│       ├── config/                 ← Configuration
│       ├── di/                     ← DI annotations
│       ├── validation/             ← Validation
│       └── server/                 ← JDK HTTP Server
├── axiom-persistence/              ← Database
├── axiom-persistence-processor/    ← @Transactional processor
└── axiom-framework/                ← Published as "axiom" (USER ADDS THIS)
```

---

## 6. TL;DR

**Users add ONE dependency: `axiom`**

Internally we have only **4 modules** (down from 8).

**Done. Simple. Clean.**
