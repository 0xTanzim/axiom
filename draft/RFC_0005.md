## Use What Fits Your Brain” — DX Philosophy & Style Freedom

**Status:** Draft

**Type:** Design / DX Philosophy

**Applies to:** Entire Framework

**Audience:** Framework users & contributors

---

## 1. Motivation

Most frameworks fail DX not because of missing features, but because they **force a single mental model** on all users.

Developers come from different ecosystems:

- TypeScript / Node
- Java / JVM
- Functional programming
- Imperative programming

Forcing *one* “correct” style:

- Increases learning cost
- Slows adoption
- Creates unnecessary friction
- Alienates experienced engineers

This framework adopts a simple principle:

> Use what fits your brain.
>

---

## 2. Core Philosophy

The framework **does not enforce a single way to write code**.

Instead, it:

- Supports multiple valid styles
- Guarantees consistent behavior
- Keeps internals unified
- Lets users choose their preferred DX

**Freedom of style is a feature, not a weakness.**

---

## 3. What “Use What Fits Your Brain” Means

### It means:

- You choose the API style
- The framework guarantees correctness
- Different styles can coexist
- No style is deprecated or second-class

### It does NOT mean:

- Chaos
- Inconsistent behavior
- Hidden differences
- Fragmented internals

---

## 4. Supported Styles (First-Class)

### 4.1 Middleware Style (TypeScript / Node mental model)

```java
app.use((c, next) -> {
    if (!c.isAuthenticated()) {
        c.status(401);
        c.text("Unauthorized");
        return;
    }
    next.run();
});

```

Best for:

- Express / Koa / Hono users
- Around-logic
- Explicit flow control
- Advanced interception

---

### 4.2 Before / After Hooks (Java / Javalin mental model)

```java
app.before(c -> {
    if (!c.isAuthenticated()) {
        c.status(401);
        c.text("Unauthorized");
    }
});

app.after(c -> {
    log(c.path());
});

```

Best for:

- Java developers
- Declarative lifecycle logic
- Logging, auth, metrics
- Minimal mental overhead

---

## 5. Equivalence Guarantee (Important Contract)

The framework guarantees:

> For most use cases, middleware and before/after are equally capable.
>

Authentication, logging, rate limiting, tracing — all can be implemented using **either style**.

No hidden advantages.

No performance difference.

No special treatment.

---

## 6. Unified Execution Model (Internal Consistency)

Although users see different APIs, internally:

```
before hooks
   ↓
middleware chain
   ↓
route handler
   ↓
middleware unwind
   ↓
after hooks

```

All styles compile into **one deterministic pipeline**.

This ensures:

- Predictability
- Performance
- Maintainability
- Debuggability

---

## 7. Response Commitment Rule (Safety Net)

### Rule:

> Once a response is written, execution stops.
>

```java
c.text("Unauthorized");

```

Effects:

- Route handler is skipped
- Middleware does not continue
- Duplicate responses are prevented

This rule applies **equally** to:

- Middleware
- Before hooks
- Route handlers

This makes all styles safe.

---

## 8. Coexistence Is Encouraged

Different teams, different preferences:

```java
app.before(c -> log(c.path()));

app.use((c, next) -> {
    transaction.begin();
    next.run();
    transaction.commit();
});

```

This is:

- Valid
- Supported
- Encouraged

The framework **does not force alignment**.

---

## 9. Documentation Rule (Very Important)

Docs must:

- Show both styles
- Avoid saying “recommended”
- Avoid implying superiority
- Explain trade-offs clearly

Official wording:

> “You can use before/after hooks or middleware.
>
>
> Both are first-class. Choose what fits your brain.”
>

---

## 10. Why This Matters (Strategic Impact)

This philosophy:

- Lowers adoption barrier
- Enables smooth migration
- Respects developer experience
- Prevents DX wars
- Future-proofs the framework

It also sends a clear signal:

> This framework is built for developers, not ideology.
>

---

## 11. Non-Goals

This RFC does NOT:

- Encourage mixing styles randomly
- Promote inconsistency within a single module
- Replace good engineering judgment

Style freedom ≠ lack of discipline.

---

## 12. Final Decision

The framework formally adopts:

> “Use what fits your brain.”
>

As a **core DX principle**.

Both:

- Middleware
- Before / After hooks

Are:

- Fully supported
- First-class
- Stable
- Equal in status

**Approved.**

---

## 13. Closing Note (Important)

This RFC is not about APIs.

It’s about **respecting how people think**.

That alone will set your framework apart.
