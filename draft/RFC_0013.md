# RFC-0013: Configuration — Zero Headache

**Status:** Draft
**Priority:** P1 (Foundational)
**Module:** `axiom-config`

---

## 1. One Sentence

> **Put your config file. It works. Done.**

---

## 2. The Problem We Solve

Users should NEVER think about:

- How config is loaded
- Source priority
- Profile resolution
- Binding mechanics

They just want: **"I put a value, I get the value."**

---

## 3. User Experience (The ONLY Thing That Matters)

### 3.1 Zero Config — It Just Works

```java
// Your app - ZERO config code needed
public class MyApp {
    public static void main(String[] args) {
        AxiomApplication.start(MyApp.class, 8080);
        // Config is already loaded. You're done.
    }
}
```

### 3.2 Need a Value? One Line.

```java
// Get any config value
String dbUrl = Config.get("database.url");
int port = Config.get("server.port", 8080);
boolean debug = Config.get("app.debug", false);
```

### 3.3 Need Type-Safe Config? One Record.

```java
// Define once
public record DatabaseConfig(
    String url,
    String username,
    String password,
    int poolSize
) {}

// Use anywhere
DatabaseConfig db = Config.bind("database", DatabaseConfig.class);
```

**That's it. Nothing else to learn.**

---

## 4. Where to Put Config (User's Choice)

Users can use ANY of these. Axiom reads them all automatically.

| Method | Example | When to Use |
|--------|---------|-------------|
| `.env` file | `DATABASE_URL=...` | Local development |
| `application.properties` | `database.url=...` | All environments |
| Environment variables | `export DATABASE_URL=...` | Production/Docker |
| System properties | `-Ddatabase.url=...` | CLI overrides |

**Users don't need to know the priority. It just works correctly.**

---

## 5. Profiles — Automatic

```
application.properties          ← Always loaded
application-dev.properties      ← Loaded when AXIOM_PROFILE=dev
application-prod.properties     ← Loaded when AXIOM_PROFILE=prod
```

Set profile via:
- `AXIOM_PROFILE=dev` (env var)
- `-Daxiom.profile=dev` (JVM)

**No code needed. No configuration of configuration.**

---

## 6. Public API (Complete)

```java
public final class Config {

    // Get values (static access - no injection needed)
    static String get(String key);
    static String get(String key, String defaultValue);
    static int get(String key, int defaultValue);
    static long get(String key, long defaultValue);
    static boolean get(String key, boolean defaultValue);
    static Duration get(String key, Duration defaultValue);

    // Bind to record (type-safe)
    static <T> T bind(String prefix, Class<T> recordType);

    // Check if loaded
    static boolean isLoaded();
}
```

**6 methods. That's the entire API.**

---

## 7. Pre-Built Framework Configs

Axiom provides ready-to-use config records:

```java
// Server config - automatic
ServerConfig server = Config.server();
// server.port(), server.host(), server.contextPath()

// Database config - automatic
DatabaseConfig db = Config.database();
// db.url(), db.username(), db.password(), db.poolSize()
```

Users don't define these. Framework provides them.

---

## 8. Error Messages (Human Readable)

When something is wrong:

```
┌─────────────────────────────────────────────────────┐
│  Configuration Error                                │
├─────────────────────────────────────────────────────┤
│  Missing: database.url                              │
│                                                     │
│  Add to application.properties:                     │
│    database.url=jdbc:postgresql://localhost/mydb    │
│                                                     │
│  Or set environment variable:                       │
│    export DATABASE_URL=jdbc:postgresql://...        │
└─────────────────────────────────────────────────────┘
```

**Tell users EXACTLY what to do. No stack traces.**

---

## 9. What Users DON'T Need to Know

These are **internal implementation details** — hidden from users:

- ❌ SmallRye Config
- ❌ ConfigMapping annotations
- ❌ WithDefault / WithName
- ❌ Config sources and ordinals
- ❌ Builder patterns
- ❌ Interceptors
- ❌ Profile loaders

**If it doesn't help users write their app, hide it.**

---

## 10. Implementation (Internal Only)

```
axiom-config/
├── Config.java              ← Public: Static accessor
├── ConfigLoader.java        ← Internal: Loads everything
├── RecordBinder.java        ← Internal: Binds to records
└── ConfigException.java     ← Public: Human-readable errors
```

Use SmallRye internally. **Never expose it.**

---

## 11. Non-Goals

- ❌ YAML/JSON/TOML (properties is enough)
- ❌ Hot reload (restart is fine)
- ❌ Encrypted config (use secret managers)
- ❌ Complex builder API (users don't need it)
- ❌ Multiple config instances (one global is fine)

---

## 12. The Axiom Promise

> **Configuration should take 0 minutes of your time.**
>
> Put a file. Get values. Ship your app.

---

## 13. Comparison

| Framework | Config Complexity | Axiom |
|-----------|-------------------|-------|
| Spring Boot | `@Value`, `@ConfigurationProperties`, profiles, YAML, precedence... | `Config.get("key")` |
| Quarkus | `@ConfigMapping`, SmallRye, build-time binding... | `Config.get("key")` |
| Micronaut | `@Property`, `@ConfigurationProperties`, injection... | `Config.get("key")` |

**Axiom: One static method. Done.**

---

## 14. Summary

```java
// The entire config experience:

// 1. Create file (application.properties or .env)
database.url=jdbc:postgresql://localhost/mydb
database.username=app

// 2. Use in code
String url = Config.get("database.url");

// 3. Or bind to record
record DbConfig(String url, String username) {}
DbConfig db = Config.bind("database", DbConfig.class);

// That's it. Ship it.
```
